<div class="max-w-7xl mx-auto p-6 space-y-6">
  @if (isLoading()) {
  <app-loading-spinner message="Chargement de la candidature..." [fullscreen]="true" />
  } @else if (errorMessage()) {
  <app-error-card [title]="'Erreur'" [message]="errorMessage()" [showRetry]="true"
    (retry)="loadCandidature(candidatureId())"></app-error-card>
  } @else {
  <button type="button" aria-label="Retour à la liste" (click)="goBack()"
    class="inline-flex items-center gap-2 text-gray-600 hover:text-primary-600 mb-4 focus:outline-none focus:ring-2 focus:ring-primary-500 cursor-pointer disabled:cursor-not-allowed">
    <i class="fas fa-arrow-left"></i>
    <span class="font-medium">Retour à la liste</span>
  </button>


  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <div class="lg:col-span-2 space-y-6">
      <div appCandidatureHero class="card" [candidature]="candidature()"></div>

      <div appCandidatureTimeline class="card" [candidature]="candidature()"></div>

      @if (candidature()?.description) {
      <div class="card transition-all hover:shadow-lg">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-3">
          <div
            class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center">
            <i class="fas fa-file-alt text-white text-sm"></i>
          </div>
          Description du poste
        </h2>
        <div class="prose prose-sm dark:prose-invert max-w-none">
          <div class="p-4 rounded-lg bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700">
            <p class="whitespace-pre-wrap leading-relaxed text-gray-700 dark:text-gray-300 m-0">{{
              candidature()!.description }}</p>
          </div>
        </div>
      </div>
      }

      @if (candidature()?.lienOffre) {
      <div class="card transition-all hover:shadow-lg">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-3">
          <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center">
            <i class="fas fa-link text-white text-sm"></i>
          </div>
          Lien de l'offre
        </h2>
        <div
          class="flex items-center gap-3 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800">
          <i class="fas fa-external-link-alt text-blue-500 flex-shrink-0"></i>
          <a [href]="candidature()!.lienOffre" target="_blank" rel="noopener noreferrer"
            class="text-primary-600 dark:text-primary-400 hover:underline truncate flex-1 font-medium">
            {{ candidature()!.lienOffre }}
          </a>
          <button type="button"
            class="btn-icon focus:outline-none focus:ring-2 focus:ring-primary-500 transition-transform hover:scale-110 cursor-pointer disabled:cursor-not-allowed"
            aria-label="Copier le lien" (click)="copyLink(candidature()!.lienOffre!)">
            <i class="fas fa-copy"></i>
          </button>
        </div>
      </div>
      }
    </div>

    <div class="space-y-6">
      @if (candidature()) {
      <div appCandidatureInfo class="card" [candidature]="candidature()"></div>

      <div appCandidatureContact class="card" [candidature]="candidature()" (copyLink)="copyLink($event)"></div>

      <div appCandidatureActions class="card" (edit)="editCandidature()" (duplicate)="duplicateCandidature()"
        (share)="shareCandidature()" (delete)="deleteCandidature()"></div>
      }
    </div>
  </div>
  }
</div>