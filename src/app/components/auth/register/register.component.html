<app-auth-card title="Inscription" subtitle="Créez votre compte Job Tracker">
  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <div>
      <label for="nom" class="form-label">Nom</label>
      <div class="relative">
        <input id="nom" type="text" formControlName="nom" required autocomplete="family-name" class="form-input pl-10"
          placeholder="Votre nom">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fas fa-user"></i></span>
      </div>
      <app-form-field-error [control]="registerForm.get('nom')" fieldName="Le nom" />
    </div>

    <div>
      <label for="prenom" class="form-label">Prénom</label>
      <div class="relative">
        <input id="prenom" type="text" formControlName="prenom" required autocomplete="given-name"
          class="form-input pl-10" placeholder="Votre prénom">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="far fa-user"></i></span>
      </div>
      <app-form-field-error [control]="registerForm.get('prenom')" fieldName="Le prénom" />
    </div>

    <div>
      <label for="email" class="form-label">Email</label>
      <div class="relative">
        <input id="email" type="email" formControlName="email" required autocomplete="email" class="form-input pl-10"
          placeholder="votre@email.com">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fas fa-envelope"></i></span>
      </div>
      <app-form-field-error [control]="registerForm.get('email')" fieldName="L'email" />
    </div>

    <div>
      <label for="password" class="form-label">Mot de passe</label>
      <div class="relative">
        <input id="password"
               [type]="hidePassword ? 'password' : 'text'"
               formControlName="password"
               required
               autocomplete="new-password"
               class="form-input pl-10 pr-10"
               placeholder="••••••••"
               (copy)="$event.preventDefault()"
               (paste)="$event.preventDefault()"
               (cut)="$event.preventDefault()">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><i class="fas fa-lock"></i></span>
        <button type="button" (click)="hidePassword = !hidePassword"
          class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200"
          tabindex="-1">
          <i [class]="hidePassword ? 'far fa-eye-slash' : 'far fa-eye'"></i>
        </button>
      </div>
      <!-- Indicateur de force du mot de passe -->
      <div class="mt-2">
        <div class="h-2 rounded bg-gray-200 dark:bg-gray-700 overflow-hidden">
          <div [ngClass]="{
            'bg-red-500': passwordStrength <= 2,
            'bg-yellow-400': passwordStrength === 3,
            'bg-blue-400': passwordStrength === 4,
            'bg-green-500': passwordStrength === 5
          }"
          [style.width]="(passwordStrength * 20) + '%'"
          class="h-2 transition-all"></div>
        </div>
        <ul class="text-xs mt-1 text-gray-500 dark:text-gray-400">
          <li *ngFor="let err of passwordErrors">{{ err }}</li>
        </ul>
      </div>
      <app-form-field-error [control]="registerForm.get('password')" fieldName="Le mot de passe" />
    </div>

    <button type="submit" [disabled]="isLoading" class="btn-primary w-full cursor-pointer disabled:cursor-not-allowed">
      @if (isLoading) {
      <div class="animate-spin rounded-full border-2 border-white border-t-transparent w-5 h-5"></div>
      <span>Inscription en cours...</span>
      } @else {
      <i class="fas fa-user-plus"></i>
      <span>S'inscrire</span>
      }
    </button>

    <div class="text-center mt-4">
      <p class="text-sm text-gray-600 dark:text-gray-400">
        Vous avez déjà un compte ?
        <a routerLink="/auth/login"
          class="text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 font-medium">Se
          connecter</a>
      </p>
    </div>
  </form>
</app-auth-card>