import{j as c,t as m}from"./chunk-MZ3ZLVUR.js";import{H as i,L as l,Q as p,Qb as d,ga as h,m as n,p as o,y as u}from"./chunk-G3X2Z5OP.js";var g=class r{API_URL=`${m.apiUrl}/candidatures`;http=p(c);candidaturesState=h([]);loadingState=h(!1);errorState=h(null);candidatures=this.candidaturesState.asReadonly();loading=this.loadingState.asReadonly();error=this.errorState.asReadonly();totalCandidatures=d(()=>this.candidatures().length);activeCandidatures=d(()=>this.candidatures().filter(t=>!t.archivee));totalActives=d(()=>this.activeCandidatures().length);candidaturesByStatus=d(()=>{let t=new Map;return this.candidatures().forEach(e=>{let a=t.get(e.statut)||[];t.set(e.statut,[...a,e])}),t});loadAll(){return this.loadingState.set(!0),this.errorState.set(null),this.http.get(this.API_URL).pipe(i({next:t=>{this.candidaturesState.set(t),this.loadingState.set(!1)},error:t=>{this.errorState.set(t.message||"Erreur lors du chargement"),this.loadingState.set(!1)}}))}getAllCandidatures(){return this.loadAll()}getCandidatureById(t){return this.http.get(`${this.API_URL}/${t}`)}createCandidature(t){return this.http.post(this.API_URL,t).pipe(i({next:e=>{this.candidaturesState.update(a=>[...a,e])}}))}updateCandidature(t,e){return this.http.put(`${this.API_URL}/${t}`,e).pipe(i({next:a=>{this.candidaturesState.update(b=>b.map(s=>s.id===t?a:s))}}))}deleteCandidature(t){return this.http.delete(`${this.API_URL}/${t}`).pipe(i({next:()=>{this.candidaturesState.update(e=>e.filter(a=>a.id!==t))}}))}updateStatut(t,e){return this.http.patch(`${this.API_URL}/${t}/statut`,{statut:e}).pipe(i({next:a=>{this.candidaturesState.update(b=>b.map(s=>s.id===t?a:s))}}))}reset(){this.candidaturesState.set([]),this.loadingState.set(!1),this.errorState.set(null)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};var v=class r{API_URL=`${m.apiUrl}/candidatures/stats`;http=p(c);getStatistiquesGlobales(){return this.http.get(`${this.API_URL}/globales`).pipe(o(1e4),u(t=>(console.error("Erreur stats:",t),n(()=>t))))}getStatistiquesParMois(){return this.http.get(`${this.API_URL}/par-mois`).pipe(o(1e4),u(t=>(console.error("Erreur stats mensuelles:",t),n(()=>t))))}getStatistiquesParJour(){return this.http.get(`${this.API_URL}/par-jour`).pipe(o(1e4),u(t=>(console.error("Erreur stats journali\xE8res:",t),n(()=>t))))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};export{g as a,v as b};
